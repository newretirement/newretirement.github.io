<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-apis/fpe/optimal_withdraw">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Optimal Withdrawal Strategy | Boldin API Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://developers.boldin.com/docs/apis/fpe/optimal_withdraw/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Optimal Withdrawal Strategy | Boldin API Documentation"><meta data-rh="true" name="description" content="When modeling an expense in FPE, there are 2 methods for specifying how that expense is sourced:"><meta data-rh="true" property="og:description" content="When modeling an expense in FPE, there are 2 methods for specifying how that expense is sourced:"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://developers.boldin.com/docs/apis/fpe/optimal_withdraw/"><link data-rh="true" rel="alternate" href="https://developers.boldin.com/docs/apis/fpe/optimal_withdraw/" hreflang="en"><link data-rh="true" rel="alternate" href="https://developers.boldin.com/docs/apis/fpe/optimal_withdraw/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.0b202edd.css">
<link rel="preload" href="/assets/js/runtime~main.3608c75e.js" as="script">
<link rel="preload" href="/assets/js/main.d584b5b2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/boldinDeveloperDocsLogo.svg" alt="Boldin Developer Docs" class="themedImage_ToTc themedImage--light_HNdA" height="20"><img src="/img/boldinDeveloperDocsLogo.svg" alt="Boldin Developer Docs" class="themedImage_ToTc themedImage--dark_i4oU" height="20"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/newretirement/fpe-api" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a class="navbar__item navbar__link buttoned" href="/docs/getting-started/">Get API &amp; widget access</a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro/">Welcome</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/getting-started/">Getting started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/concepts/">Boldin concepts and models</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/widgets/">Widgets</a><button aria-label="Toggle the collapsible sidebar category &#x27;Widgets&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/apis/">APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/financial-planning-engine-fpe/">Financial Planning Engine (FPE)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Financial Planning Engine (FPE)&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apis/fpe/overview/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apis/fpe/datatypes/">Data Structures and Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apis/fpe/income_linked_contribs/">Income-Linked Contributions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/apis/fpe/optimal_withdraw/">Optimal Withdrawal Strategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apis/fpe/output_streams/">Output Streams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apis/fpe/terms/">Terminology</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="house" class="svg-inline--fa fa-house" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M567.5 229.7C577.6 238.3 578.9 253.4 570.3 263.5C561.7 273.6 546.6 274.9 536.5 266.3L512 245.5V432C512 476.2 476.2 512 432 512H144C99.82 512 64 476.2 64 432V245.5L39.53 266.3C29.42 274.9 14.28 273.6 5.7 263.5C-2.875 253.4-1.634 238.3 8.473 229.7L272.5 5.7C281.4-1.9 294.6-1.9 303.5 5.7L567.5 229.7zM144 464H192V312C192 289.9 209.9 272 232 272H344C366.1 272 384 289.9 384 312V464H432C449.7 464 464 449.7 464 432V204.8L288 55.47L112 204.8V432C112 449.7 126.3 464 144 464V464zM240 464H336V320H240V464z"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/apis/"><span itemprop="name">APIs</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/financial-planning-engine-fpe/"><span itemprop="name">Financial Planning Engine (FPE)</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Optimal Withdrawal Strategy</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Optimal Withdrawal Strategy</h1><p>When modeling an <a href="/docs/apis/fpe/terms/#expense-stream">expense</a> in FPE, there are 2 methods for specifying how that expense is sourced:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="method-1-withdraw-exclusively-from-a-specific-account">METHOD 1: Withdraw exclusively from a specific account<a href="#method-1-withdraw-exclusively-from-a-specific-account" class="hash-link" aria-label="Direct link to METHOD 1: Withdraw exclusively from a specific account" title="Direct link to METHOD 1: Withdraw exclusively from a specific account">​</a></h3><p>In this example, $10,000 will be withdrawn annually, and <u><em>only</em></u>, from the source account named <code>&quot;savings&quot;</code>.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;vacation&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;paymentAmount&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;source&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;savings&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;paymentsPerYear&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If there are insufficient funds in the <code>&quot;vacation&quot;</code> account to cover the expense, then the actual payment will end up being the account’s remaining balance, and an <a href="/docs/apis/fpe/overview/#what-is-a-warning">insufficientFunds warning</a> will be emitted in the FPE response.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="method-2-optimal-withdrawal-strategy">METHOD 2: Optimal Withdrawal Strategy<a href="#method-2-optimal-withdrawal-strategy" class="hash-link" aria-label="Direct link to METHOD 2: Optimal Withdrawal Strategy" title="Direct link to METHOD 2: Optimal Withdrawal Strategy">​</a></h3><p>This example demonstrates the <em>optimal withdrawal strategy</em>. As in the previous example, $10,000 will be withdrawn annually.  However, since the funding source is set to <code>&quot;optimal&quot;</code>, FPE can potentially withdraw the requested $10K from multiple “shortfall” accounts if the first chosen account can’t cover the full amount.</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;medical_expenses&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;paymentAmount&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">10000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;source&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;optimal&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token property">&quot;paymentsPerYear&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>FPE evaluates all accounts in the plan, and then derives an optimal withdrawal order when satisfying the full expense amount.  The following 3-stage procedure determines the account withdrawal order:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-1">STAGE 1<a href="#stage-1" class="hash-link" aria-label="Direct link to STAGE 1" title="Direct link to STAGE 1">​</a></h4><p>Withdraw from the user-specified default checking account (i.e. <a href="/docs/apis/fpe/datatypes/#cashflow">plan.cashFlow.checkingAccount</a>).</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-2">STAGE 2<a href="#stage-2" class="hash-link" aria-label="Direct link to STAGE 2" title="Direct link to STAGE 2">​</a></h4><p>Based on their <a href="/docs/apis/fpe/datatypes/#accounttype">account type</a>, assign the remaining accounts to the ordered categories below; then sort the accounts based on this category ordering:</p><ul><li>category 0: RMD-eligible accounts <b>having unsatisfied RMD withdrawals</b></li><li>category 1: <code>afterTax</code></li><li>category 2: <code>reverseMortgage</code></li><li>category 3: <code>ira</code>, <code>401k</code>, <code>403b</code>, <code>457b</code></li><li>category 4: <code>aftertax401k</code>, <code>aftertax403b</code></li><li>category 5: <code>rothIRA</code>, <code>roth401k</code>, <code>roth403b</code>, <code>roth457b</code></li><li>category 6: <code>hsa</code></li><li>category 7: <code>revolvingCredit</code></li></ul><p>Note that:</p><ul><li>RMD-eligible accounts include <code>ira</code>, <code>401k</code>, <code>403b</code>, and <code>457b</code></li><li>Any account type not explicitly defined within the above categories will NOT be withdrawn from.
</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="stage-3">STAGE 3<a href="#stage-3" class="hash-link" aria-label="Direct link to STAGE 3" title="Direct link to STAGE 3">​</a></h4><ol><li>Within each account category, sort accounts by increasing <a href="https://www.investopedia.com/terms/r/rateofreturn.asp" target="_blank" rel="noopener noreferrer">RoR</a> (specified by <a href="/docs/apis/fpe/datatypes/#account">account.rate</a>)</li><li>Within each <em>(category, RoR)</em> equivalence class, the original account order is intentionally preserved to give the API client control over the withdrawal order.</li><li>An account will <strong>not</strong> be withdrawn from if:<ul><li>Its <a href="/docs/apis/fpe/datatypes/#account">disableOptimalWithdraw</a> flag is set to true</li><li>Its <a href="/docs/apis/fpe/datatypes/#accounttype">account type</a> is not listed in one of the above categories (e.g. a <code>loan</code>)</li></ul></li></ol><p>Once the account withdrawal order has been determined for a given month, FPE then attempts to withdraw the requested amount from each account until the full expense has been funded.  If the first account in the withdrawal sequence has insufficient funds, the remaining balance is withdrawn, and FPE moves on to the next account in the sequence, and so on.</p><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="relevant-terms">Relevant Terms<a href="#relevant-terms" class="hash-link" aria-label="Direct link to Relevant Terms" title="Direct link to Relevant Terms">​</a></h2><ul><li><a href="/docs/apis/fpe/datatypes/#account">account</a></li><li><a href="/docs/apis/fpe/datatypes/#accounttype">accountType</a></li><li><a href="/docs/apis/fpe/terms/#expense-stream">expense stream</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/apis/fpe/income_linked_contribs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Income-Linked Contributions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/apis/fpe/output_streams/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Output Streams</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#method-1-withdraw-exclusively-from-a-specific-account" class="table-of-contents__link toc-highlight">METHOD 1: Withdraw exclusively from a specific account</a></li><li><a href="#method-2-optimal-withdrawal-strategy" class="table-of-contents__link toc-highlight">METHOD 2: Optimal Withdrawal Strategy</a></li><li><a href="#relevant-terms" class="table-of-contents__link toc-highlight">Relevant Terms</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid footerContainer_rP2H"><div class="row"><div class="col col-6 text--left"><span><div class="footer__copyright">Copyright © 2024 Boldin, Inc.</div></span></div><div class="col col-6 text--right"><div class="footer__links text--right"><div class="footer__links"><a href="https://github.com/newretirement/fpe-api" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a><span class="footer__link-separator"> </span><a href="mailto:sales@boldin.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us</a><span class="footer__link-separator"> </span><a href="https://www.boldin.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Boldin.com</a></div></div></div></div></div></footer></div>
<script src="/assets/js/runtime~main.3608c75e.js"></script>
<script src="/assets/js/main.d584b5b2.js"></script>
</body>
</html>